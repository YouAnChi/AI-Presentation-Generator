# AI PPT æ™ºèƒ½ç”Ÿæˆç³»ç»Ÿ (AI Presentation Generator)

è¿™æ˜¯ä¸€ä¸ªåŸºäº **A2A (Agent-to-Agent)** åè®®å’Œ **MCP (Model Context Protocol)** æ¶æ„çš„æ™ºèƒ½ PPT ç”Ÿæˆç³»ç»Ÿã€‚æœ¬é¡¹ç›®æ—¨åœ¨å±•ç¤ºå¦‚ä½•åˆ©ç”¨å¤šæ™ºèƒ½ä½“åä½œï¼ˆMulti-Agent Collaborationï¼‰æ¥å®Œæˆä»éœ€æ±‚åˆ†æã€å†…å®¹åˆ›ä½œã€è§†è§‰è®¾è®¡åˆ°æœ€ç»ˆæ–‡ä»¶ç”Ÿæˆçš„å…¨æµç¨‹è‡ªåŠ¨åŒ–ä»»åŠ¡ã€‚

## ğŸ¯ é¡¹ç›®æ„¿æ™¯

æ‰“é€ ä¸€ä¸ª**â€œè™šæ‹Ÿè®¾è®¡å·¥ä½œå®¤â€**ï¼Œç”¨æˆ·åªéœ€è¾“å…¥ä¸€ä¸ªç®€å•çš„ä¸»é¢˜ï¼ˆä¾‹å¦‚ï¼šâ€œå¸®æˆ‘åšä¸€ä¸ªå…³äº AI æœªæ¥å‘å±•çš„èèµ„ PPTâ€ï¼‰ï¼Œç³»ç»Ÿä¸­çš„å„ä¸ª AI æ™ºèƒ½ä½“å°±ä¼šè‡ªåŠ¨åˆ†å·¥åä½œï¼Œæœ€ç»ˆäº¤ä»˜ä¸€ä»½ä¸“ä¸šã€ç¾è§‚ä¸”å†…å®¹è¯¦å®çš„ `.pptx` æ–‡ä»¶ã€‚

## ğŸ—ï¸ æ ¸å¿ƒæ¶æ„

æœ¬é¡¹ç›®é‡‡ç”¨äº†æ¨¡ä»¿ç°å®ä¸–ç•Œè®¾è®¡å›¢é˜Ÿçš„åˆ†å·¥æ¨¡å¼ï¼Œæ ¸å¿ƒè§’è‰²åŒ…æ‹¬ï¼š

1.  **é¡¹ç›®ç»ç† (Project Manager / Orchestrator)**
    *   **è§’è‰²**ï¼šæ€»æŒ‡æŒ¥ã€ç”¨æˆ·æ¥å£ã€‚
    *   **èŒè´£**ï¼šæ¥æ”¶ç”¨æˆ·æŒ‡ä»¤ï¼Œç»´æŠ¤é¡¹ç›®ä¸Šä¸‹æ–‡ï¼ˆé£æ ¼ã€é¡µæ•°ã€å—ä¼—ï¼‰ï¼Œåè°ƒå„ä¸ªä¸“å‘˜çš„å·¥ä½œï¼Œå¹¶ç›‘æ§è¿›åº¦ã€‚
2.  **å¤§çº²ç­–åˆ’å¸ˆ (Outliner Agent)**
    *   **è§’è‰²**ï¼šé€»è¾‘å¤§è„‘ã€‚
    *   **èŒè´£**ï¼šå°†æ¨¡ç³Šçš„éœ€æ±‚æ‹†è§£ä¸ºç»“æ„åŒ–çš„ PPT å¤§çº²ï¼ˆæ¯é¡µæ ‡é¢˜ã€æ ¸å¿ƒè®ºç‚¹ï¼‰ã€‚
3.  **é‡‘ç‰Œæ–‡æ¡ˆ (Copywriter Agent)**
    *   **è§’è‰²**ï¼šå†…å®¹åˆ›ä½œè€…ã€‚
    *   **èŒè´£**ï¼šæ ¹æ®å¤§çº²æ ‡é¢˜ï¼Œæ’°å†™è¯¦ç»†çš„æ­£æ–‡å†…å®¹ã€æ¼”è®²å¤‡æ³¨ (Speaker Notes)ã€‚
4.  **è§†è§‰è®¾è®¡å¸ˆ (Visual Designer Agent)**
    *   **è§’è‰²**ï¼šç¾æœ¯æŒ‡å¯¼ã€‚
    *   **èŒè´£**ï¼šæ ¹æ®é¡µé¢å†…å®¹ç”Ÿæˆé…å›¾æç¤ºè¯ (Prompt) å¹¶è°ƒç”¨ç»˜å›¾æ¨¡å‹ç”Ÿæˆå›¾ç‰‡ã€‚
5.  **æ’ç‰ˆå·¥ç¨‹å¸ˆ (Builder Agent)**
    *   **è§’è‰²**ï¼šæŠ€æœ¯æ‰§è¡Œã€‚
    *   **èŒè´£**ï¼šä½¿ç”¨ `python-pptx` å°†æ–‡æ¡ˆå’Œå›¾ç‰‡ç»„è£…æˆæœ€ç»ˆçš„ `.pptx` æ–‡ä»¶ã€‚

æ‰€æœ‰æ™ºèƒ½ä½“é€šè¿‡ **MCP Server** è¿›è¡Œæ³¨å†Œå’Œå‘ç°ï¼Œå®ç°äº†é«˜åº¦çš„è§£è€¦å’Œå¯æ‰©å±•æ€§ã€‚

## ğŸ“‚ ç›®å½•ç»“æ„

```
ai_ppt_generator/
â”œâ”€â”€ agent_cards/            # æ™ºèƒ½ä½“åç‰‡ (Agent Cards)
â”‚   â”œâ”€â”€ orchestrator_agent.json
â”‚   â”œâ”€â”€ outliner_agent.json
â”‚   â”œâ”€â”€ copywriter_agent.json
â”‚   â””â”€â”€ builder_agent.json
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ ai_ppt/
â”‚   â”‚   â”œâ”€â”€ agents/         # æ™ºèƒ½ä½“å…·ä½“å®ç°ä»£ç 
â”‚   â”‚   â”‚   â”œâ”€â”€ orchestrator.py
â”‚   â”‚   â”‚   â”œâ”€â”€ outliner.py
â”‚   â”‚   â”‚   â”œâ”€â”€ copywriter.py
â”‚   â”‚   â”‚   â””â”€â”€ builder.py
â”‚   â”‚   â”œâ”€â”€ common/         # å…¬å…±å·¥å…·åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ base_agent.py
â”‚   â”‚   â”‚   â”œâ”€â”€ server_utils.py
â”‚   â”‚   â”‚   â””â”€â”€ types.py
â”‚   â”‚   â””â”€â”€ mcp/            # MCP é›†æˆç¤ºä¾‹
â”‚   â”‚       â”œâ”€â”€ server.py
â”‚   â”‚       â”œâ”€â”€ client.py
â”‚   â”‚       â”œâ”€â”€ a2a_client.py
â”‚   â”‚       â””â”€â”€ a2a_mcp_server.py
â”œâ”€â”€ output/                 # ç”Ÿæˆçš„ PPT æ–‡ä»¶è¾“å‡ºç›®å½•ï¼ˆè¿è¡Œåè‡ªåŠ¨åˆ›å»ºï¼‰
â”œâ”€â”€ .env                    # å¯é€‰ï¼šç¯å¢ƒå˜é‡æ–‡ä»¶ï¼ˆè‹¥ä½¿ç”¨å¤–éƒ¨åŠ è½½ï¼‰
â”œâ”€â”€ pyproject.toml          # é¡¹ç›®ä¾èµ–ä¸æ‰“åŒ…é…ç½®
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
*   Python 3.13+
*   Google Gemini API Keyï¼ˆç¯å¢ƒå˜é‡ `GOOGLE_API_KEY`ï¼‰
*   å¯é€‰ï¼šOpenAI / Midjourney API Keyï¼ˆç”¨äºå›¾ç‰‡ç”Ÿæˆï¼‰

### å®‰è£…ä¸è¿è¡Œ

1.  **è¿›å…¥é¡¹ç›®ç›®å½•**
    ```bash
    cd samples/python/agents/ai_ppt_generator
    ```

2.  **é…ç½®ç¯å¢ƒå˜é‡**
    ```bash
    export GOOGLE_API_KEY=ä½ çš„Geminiå¯†é’¥
    ```

3.  **å¯åŠ¨å„æ™ºèƒ½ä½“æœåŠ¡ï¼ˆA2Aï¼‰**
    ```bash
    # å¯åŠ¨ Orchestratorï¼ˆé¡¹ç›®ç»ç†ï¼‰
    python src/ai_ppt/agents/orchestrator.py --host localhost --port 10200
    # å¯åŠ¨ Outlinerï¼ˆå¤§çº²ç­–åˆ’ï¼‰
    python src/ai_ppt/agents/outliner.py --host localhost --port 10201
    # å¯åŠ¨ Copywriterï¼ˆæ–‡æ¡ˆæ’°å†™ï¼‰
    python src/ai_ppt/agents/copywriter.py --host localhost --port 10202
    # å¯åŠ¨ Builderï¼ˆæ’ç‰ˆå·¥ç¨‹å¸ˆï¼‰
    python src/ai_ppt/agents/builder.py --host localhost --port 10203
    ```

4.  **ï¼ˆå¯é€‰ï¼‰å¯åŠ¨ MCP Server å¹¶é€šè¿‡å·¥å…·è°ƒç”¨**
    ```bash
    # å¯åŠ¨ MCP Serverï¼ˆå°† agent_cards ç›®å½•æ³¨å†Œä¸ºå·¥å…·æä¾›è€…ï¼‰
    python src/ai_ppt/mcp/a2a_mcp_server.py
    ```

5.  **å‘é€æŒ‡ä»¤**
    - æ–¹å¼ä¸€ï¼ˆA2A æµå¼ï¼‰ï¼šè¿è¡Œ `python src/ai_ppt/mcp/a2a_client.py "ç”Ÿæˆä¸€ä»½å…³äºæ–°èƒ½æºæ±½è½¦å¸‚åœºåˆ†æçš„ PPT"`
    - æ–¹å¼äºŒï¼ˆMCP å·¥å…·ï¼‰ï¼šè¿è¡Œ `python src/ai_ppt/mcp/client.py "ç”Ÿæˆä¸€ä»½å…³äºæ–°èƒ½æºæ±½è½¦å¸‚åœºåˆ†æçš„ PPT"`

æç¤ºï¼šå½“å‰ MCP `server.py` ç¤ºä¾‹ä¸­çš„ `generate_ppt` ä½¿ç”¨ä¸€æ¬¡æ€§è§¦å‘ï¼Œè‹¥éœ€ä¸¥æ ¼è½ç›˜æ–‡ä»¶è¿”å›ï¼Œè¯·åœ¨ `OrchestratorAgent` ä¸­è¡¥å…… `run` æ–¹æ³•æˆ–æ”¹ä¸ºæ±‡èš A2A æµå¼æœ€ç»ˆç»“æœã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

*   **A2A Protocol**: æ™ºèƒ½ä½“é€šä¿¡æ ‡å‡†ã€‚
*   **Model Context Protocol (MCP)**: å·¥å…·ä¸æœåŠ¡å‘ç°ã€‚
*   **LangGraph**: ç”¨äºæ„å»ºå¤æ‚çš„è§„åˆ’å’ŒçŠ¶æ€æµã€‚
*   **Google Gemini**: æ ¸å¿ƒæ¨ç†æ¨¡å‹ã€‚
*   **python-pptx**: PPT æ–‡ä»¶ç”Ÿæˆå¼•æ“ã€‚
*   **python-dotenv**: ç¯å¢ƒå˜é‡ç®¡ç†ã€‚

## ğŸ§© æ¶æ„è¯¦è§£

- æ™ºèƒ½ä½“åŸºç±»ï¼š`src/ai_ppt/common/base_agent.py:10` å®šä¹‰ç»Ÿä¸€çš„ `AgentCard` ç”Ÿæˆä¸ `stream` è¿”å›æ ¼å¼ã€‚
- é¡¹ç›®ç»ç†ï¼ˆOrchestratorï¼‰ï¼š`src/ai_ppt/agents/orchestrator.py:17` è´Ÿè´£æ•´ä½“ç¼–æ’ï¼›é€šè¿‡ MCP æŸ¥æ‰¾èƒ½åŠ›å¡ `src/ai_ppt/agents/orchestrator.py:25`ï¼Œå†ç”¨ A2A è¯·æ±‚è°ƒç”¨å¤–éƒ¨æ™ºèƒ½ä½“ `src/ai_ppt/agents/orchestrator.py:39`ã€‚
- å¤§çº²ç­–åˆ’ï¼ˆOutlinerï¼‰ï¼š`src/ai_ppt/agents/outliner.py:13` ä½¿ç”¨ Gemini ç»“æ„åŒ–è¾“å‡ºç”Ÿæˆ `PresentationOutline`ï¼Œé“¾è·¯å®šä¹‰åœ¨ `src/ai_ppt/agents/outliner.py:20-37`ã€‚
- æ–‡æ¡ˆæ’°å†™ï¼ˆCopywriterï¼‰ï¼š`src/ai_ppt/agents/copywriter.py:13` åŸºäºå•é¡µæ ‡é¢˜ä¸å¸ƒå±€è¡¥å…¨æ­£æ–‡ä¸æ¼”è®²å¤‡æ³¨ï¼Œé“¾è·¯åœ¨ `src/ai_ppt/agents/copywriter.py:20-36`ã€‚
- æ’ç‰ˆå·¥ç¨‹å¸ˆï¼ˆBuilderï¼‰ï¼š`src/ai_ppt/agents/builder.py:13` å°†ç»“æ„åŒ–å†…å®¹å†™å…¥ `.pptx`ï¼Œæ ¸å¿ƒæ–¹æ³• `build_presentation` åœ¨ `src/ai_ppt/agents/builder.py:23`ã€‚
- MCP é›†æˆï¼šç¤ºä¾‹å·¥å…·ä¸æœåŠ¡åœ¨ `src/ai_ppt/mcp/server.py:1`ã€`src/ai_ppt/mcp/client.py:8`ï¼Œä»¥åŠ A2A æµ‹è¯•å®¢æˆ·ç«¯ `src/ai_ppt/mcp/a2a_client.py:1`ã€‚

## ğŸ§± æ•°æ®æ¨¡å‹

- `SlideContent`ï¼š`src/ai_ppt/common/types.py:4-12`
  - å…³é”®å­—æ®µï¼š`page_number`ã€`title`ã€`layout`ã€`body_text`ã€`speaker_notes`ã€`image_prompt`ã€`image_path`
- `PresentationOutline`ï¼š`src/ai_ppt/common/types.py:14-18`
  - ç»“æ„ï¼š`topic` + `slides[List[SlideContent]]`
- `PPTGenerationRequest`ï¼š`src/ai_ppt/common/types.py:19-23`
  - ç”¨é€”ï¼šä¸º Outliner æŒ‡å®š `topic`ã€`num_slides`ã€`style`

## ğŸ”„ å·¥ä½œæµç¨‹

- è¾“å…¥è§£æï¼š`OrchestratorAgent.stream` æ¥æ”¶ä¸»é¢˜å¹¶åˆ›å»ºè¯·æ±‚ `src/ai_ppt/agents/orchestrator.py:116-127`ã€‚
- è§„åˆ’å¤§çº²ï¼šé€šè¿‡ MCP æŸ¥æ‰¾ Outliner å¹¶è°ƒç”¨ç”Ÿæˆå¤§çº² `src/ai_ppt/agents/orchestrator.py:129-153`ã€‚
- é€é¡µå†™ç¨¿ï¼šå¾ªç¯è°ƒç”¨ Copywriter è¡¥å…¨æ­£æ–‡ä¸å¤‡æ³¨ `src/ai_ppt/agents/orchestrator.py:159-189`ã€‚
- æ–‡ä»¶ç”Ÿæˆï¼šè°ƒç”¨ Builder è½ç›˜ `.pptx` å¹¶è¿”å›è·¯å¾„ `src/ai_ppt/agents/orchestrator.py:192-199` ä¸ `src/ai_ppt/agents/builder.py:23-61`ã€‚

## âš™ï¸ æ—¥å¿—ä¸é”™è¯¯å¤„ç†

- ç»Ÿä¸€æ—¥å¿—ï¼š`get_logger` è®¾ç½®åŸºæœ¬æ—¥å¿—æ ¼å¼ `src/ai_ppt/common/utils.py:5-7`ã€‚
- å¤–éƒ¨è°ƒç”¨å¼‚å¸¸ï¼šOrchestrator åœ¨ A2A è°ƒç”¨å¤„æ•è·å¹¶æ‰“å°è¯¦ç»†å †æ ˆ `src/ai_ppt/agents/orchestrator.py:103-114`ã€‚
- è§£æå¥å£®æ€§ï¼šå¯¹è¿”å›å†…å®¹è¿›è¡Œ Markdown åŒ…è£¹æ¸…ç†ä¸ JSON è§£æå®¹é”™ `src/ai_ppt/agents/orchestrator.py:137-157`ã€‚

## ğŸ”Œ æ‰©å±•ä¸å®šåˆ¶

- æ–°å¢æ™ºèƒ½ä½“ï¼šæŒ‰ `BaseAgent` æ¨¡å¼å®ç° `stream`ï¼›åœ¨ `agent_cards` ä¸­å£°æ˜æŠ€èƒ½ï¼ŒMCP å³å¯å‘ç°ã€‚
- å¢å¼ºç‰ˆå›¾ç‰‡ç”Ÿæˆï¼šå½“å‰ç¤ºä¾‹æœªåŒ…å« `designer.py`ï¼Œå¯æ–°å¢â€œè§†è§‰è®¾è®¡å¸ˆâ€æ™ºèƒ½ä½“ï¼Œæ ¹æ® `image_prompt` ç”Ÿæˆå›¾ç‰‡å¹¶åœ¨ Builder ä¸­æ’å…¥ã€‚
- è°ƒç”¨é“¾æ‰©å±•ï¼šå¯å¼•å…¥ LangGraph è¿›è¡Œæ›´å¤æ‚çš„çŠ¶æ€æœºç¼–æ’ï¼ˆå½“å‰ç¤ºä¾‹ä»¥ç›´çº¿æµç¨‹æ¼”ç¤ºï¼‰ã€‚

## â“å¸¸è§é—®é¢˜

- ä¸ºä»€ä¹ˆæ²¡æœ‰ `run.sh`ï¼Ÿå½“å‰ç¤ºä¾‹ä½¿ç”¨ç‹¬ç«‹ Python è¿›ç¨‹å¯åŠ¨å„æ™ºèƒ½ä½“ï¼Œå‘½ä»¤æ›´ç›´è§‚ã€ä¾¿äºè°ƒè¯•ã€‚
- `.env` æ˜¯å¦å¿…é¡»ï¼Ÿä»£ç ç›´æ¥è¯»å–ç¯å¢ƒå˜é‡ `GOOGLE_API_KEY`ï¼Œä½ ä¹Ÿå¯ä»¥ç”¨ç³»ç»Ÿç¯å¢ƒæˆ–å¤–éƒ¨åŠ è½½ `.env`ã€‚
- MCP ç«¯åˆ°ç«¯ç”Ÿæˆæ€ä¹ˆç”¨ï¼Ÿç¤ºä¾‹ `server.py` æš‚ä»¥å·¥å…·æ¼”ç¤ºï¼Œå»ºè®®èµ° A2A æµå¼ç¼–æ’ï¼›å¦‚éœ€ä¸€æ¬¡æ€§è¿”å›æ–‡ä»¶è·¯å¾„ï¼Œè¯·åœ¨ Orchestrator è¡¥å…… `run` æˆ–åœ¨ `server.py` å¤„ç†æ±‡èšã€‚

## ğŸ“ˆ æ”¹è¿›è®¡åˆ’

*   **å¢å¼ºé”™è¯¯å¤„ç†**: å¢åŠ å¯¹ A2A é€šä¿¡ä¸­æ–­å’Œè§£æé”™è¯¯çš„è‡ªåŠ¨é‡è¯•æœºåˆ¶ã€‚
*   **æ”¯æŒæ›´å¤šæ¨¡å‹**: å…¼å®¹ OpenAIã€Anthropic ç­‰æ›´å¤š LLM æä¾›å•†ã€‚
*   **å¯è§†åŒ–è¿›åº¦**: åœ¨ CLI ä¸­æä¾›æ›´å‹å¥½çš„è¿›åº¦æ¡å’ŒçŠ¶æ€å±•ç¤ºã€‚
*   **æ–­ç‚¹ç»­ä¼ **: æ”¯æŒä»å¤±è´¥çš„æ­¥éª¤ï¼ˆå¦‚æ–‡æ¡ˆç”Ÿæˆä¸­æ–­åï¼‰ç»§ç»­æ‰§è¡Œï¼Œè€Œæ— éœ€é‡å¤´å¼€å§‹ã€‚


